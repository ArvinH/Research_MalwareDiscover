'''
@author ArvinH
@date 2014/01/29

'''
import sys
class checkduplicateddata:
   def __init__(self):
        self.count = 0 
   def check(self,path,output):
             node1List = set()
             node2List = set()
             f = open(output,'w',encoding='utf-8')
             f2 = open('dup', 'w', encoding='utf-8')
             with open(path,'r',encoding='utf-8') as node: 
                  for line in node:  
                     data = line.strip().split('\t')
                     if data[0] in node1List:
                        self.count = self.count + 1
                        f2.write(data[0]+'\n')
                     else:
                        node1List.add(data[0]) 
                        f.write(line)
             print("duplicate edge: "+str(self.count))
             f.close()
             f2.close()


def main ():
    path = sys.argv[1]
    output = sys.argv[2]
    f = checkduplicateddata()
    f.check(path,output)
if __name__ == '__main__' :
    main()

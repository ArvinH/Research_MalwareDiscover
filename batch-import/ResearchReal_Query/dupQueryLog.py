'''
@author ArvinH
@date 2014/06/16
'''
import sys
from datetime import datetime
from datetime import timedelta

class dupQueryLog:
   def dup(self, ori_log):
      with open(ori_log, 'r', encoding='utf-8') as ori_querylog:
         for line in ori_querylog:
            data = line.strip().split('\t')
            d = datetime.strptime(data[0], '%Y-%m-%d %H:%M:%S')
            day_delta = timedelta(days=1)
            hour_delta = timedelta(hours=3)
            D = d + day_delta
            Ds = D + hour_delta
            print(line.strip())
            print(str(D)+'\t'+data[1]+'\t'+data[2]+'\t'+data[3]+'\t'+data[4])
            print(str(Ds)+'\t'+data[1]+'\t'+data[2]+'\t'+data[3]+'\t'+data[4])


def main ():
   filepath = sys.argv[1]
   f = dupQueryLog()
   f.dup(filepath)
   
if __name__ == '__main__' :
   main()

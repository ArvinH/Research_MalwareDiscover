'''
@author ArvinH
@date 2013/07/05

'''
import sys
class checkduplicateddata:
   def __init__(self):
        self.doc = '' 
   def check(self, file1):
             count = 0
             edge1List = set()
             f = open(file1+'_clean','w',encoding='utf-8')
             with open(file1,'r',encoding='utf-8') as edge1: 
                  for line in edge1:  
                     data = line.strip().split('\t')
                     content = data[0]+'\t'+data[1]
                     if content not in edge1List:
                        edge1List.add(data[0]+'\t'+data[1]) 
                        edge1List.add(data[1]+'\t'+data[0])
                        f.write(line)
                     else:
                        count = count + 1
                        print(data[0]+'\t'+data[1])
             f.close()
   # for node file 
   def checkNode(self, file1):
             count = 0
             edge1List = set()
             contentList = dict()
             f = open(file1+'_clean','w',encoding='utf-8')
             with open(file1,'r',encoding='utf-8') as edge1: 
                  for line in edge1:  
                     data = line.strip().split('\t')
                     content = data[0]
                     if content not in edge1List:
                        edge1List.add(data[0]) 
                        contentList[data[0]] = line
                     else:
                        if data[1] == '1':
                           contentList[data[0]] = line
                        count = count + 1
                        print(data[0]+'\t'+data[1])
             for key in contentList:
                f.write(contentList[key])



             f.close()


def main ():
    file1 = sys.argv[1]
    option = sys.argv[2]
    f = checkduplicateddata()
    if option == "edge":
       f.check(file1)
    else:
      f.checkNode(file1)
if __name__ == '__main__' :
    main()

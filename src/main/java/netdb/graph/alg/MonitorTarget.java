package netdb.graph.alg;

import java.util.Properties;

import netdb.graph.unit.CacheManager;

import com.tinkerpop.blueprints.Vertex;


public class MonitorTarget {
	private String target_type;
	private String[] TargetPartIDList;
	private String[] TargetVertexID;
	public MonitorTarget(){
		  Properties prop = new Properties();
		  
          this.target_type = prop.getProperty("TARGET_TYPE");
          
          this.TargetPartIDList = prop.getProperty("TARGET_PARTID").split(",");
          
          this.TargetVertexID = prop.getProperty("TARGET_VERTEXID").split(",");
          
	}
	public void monitor(){
		CacheManager CM = new CacheManager();
		for(String targetPartID : TargetPartIDList){
			CM.loadGraphToCache(targetPartID);
		}
		Vertex target = null;
		String count = null;
		for(String targetID : this.TargetVertexID){
			target = CM.findVertexInCache(targetID);
			count = target.getProperty("count");
			System.out.println("Target:-"+target.getId()+"\tCount: "+count);
		}
		
	}
	
	public static void main(String[] args){
		MonitorTarget monitor = new MonitorTarget();
		monitor.monitor();
	}

}

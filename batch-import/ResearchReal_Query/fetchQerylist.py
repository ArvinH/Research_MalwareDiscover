'''
@author ArvinH
@date 2014/04/07
'''
import sys

class fetchQueryList:
  def countQuery(self, queryfile):
     count = 0
     with open(queryfile, 'r', encoding='utf-8') as queryFile:
       for line in queryFile:
          data = line.strip().split('\t')
          del data[0]
          for query in data:
             if query != 'None':
                count = count + 1
     print('Total query amount = '+str(count)) 
  
  def fetch(self,queryfile):
     with open(queryfile, 'r', encoding='utf-8') as queryFile:
       for line in queryFile:
         data = line.strip().split('\t')
         if data[2] == 'None' and data[3] == 'None' and data[5] == 'None' and data[6] == 'None' and data[7] == 'None':
            pass
         else:
            temp_time = data[1].split('.')
            temp_time2 = temp_time[0].split('T') 
            time = temp_time2[0]+' '+temp_time2[1]
            print(time+'\t'+data[2]+'\t'+data[3]+'\t'+data[5]+'\t'+data[6])




def main ():
  filepath = sys.argv[1]
  signal = sys.argv[2]
  f = fetchQueryList()
  if signal == 'fetch':
    f.fetch(filepath)
  elif signal == 'count':
    f.countQuery(filepath)




if __name__ == '__main__' :
    main()
